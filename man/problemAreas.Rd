% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/edge_helper_functions.R
\name{problemAreas}
\alias{problemAreas}
\title{Identify all problem areas in spatial transcriptomics data}
\usage{
problemAreas(
  .xyz,
  offTissue,
  uniqueIdentifier = NA,
  shifted = FALSE,
  min_cluster_size = 40
)
}
\arguments{
\item{.xyz}{Data frame with spot coordinates and QC metrics. Must contain:
\itemize{
\item Column 1: array_row coordinates
\item Column 2: array_col coordinates
\item Column 3: Binary outlier indicator (TRUE/FALSE or 1/0)
\item Row names: Spot identifiers
}}

\item{offTissue}{Character vector of spot identifiers that are off-tissue}

\item{uniqueIdentifier}{Character string used as prefix for cluster IDs.
If NA, "X" will be used (default: NA)}

\item{shifted}{Logical indicating whether to apply coordinate adjustment
for hexagonal arrays (default: FALSE)}

\item{min_cluster_size}{Numeric value for minimum cluster size in
morphological operations (default: 40)}
}
\value{
Data frame with the following columns:
\itemize{
\item spotcode: Spot identifier
\item clumpID: Unique cluster identifier (format: "prefix_number")
\item clumpSize: Number of spots in the cluster
}
Returns empty data frame if no problem areas are found.
}
\description{
Detects and characterizes all clusters of low-quality spots (problem areas)
in tissue sections, including both edge and interior artifacts.
}
\details{
This function identifies ALL connected components of outlier spots,
not just those touching edges. Each cluster is assigned a unique ID and
its size is calculated. This enables downstream filtering based on
cluster characteristics.
}
\examples{
\dontrun{
# Identify all problem areas in a sample
problem_df <- problemAreas(
  spot_data,
  offTissue = rownames(spot_data)[!spe$in_tissue],
  uniqueIdentifier = "Sample1"
)

# Filter for large problem areas
large_problems <- problem_df[problem_df$clumpSize > 50, ]

# Get spots in specific cluster
cluster1_spots <- problem_df[problem_df$clumpID == "Sample1_1", "spotcode"]
}

}
